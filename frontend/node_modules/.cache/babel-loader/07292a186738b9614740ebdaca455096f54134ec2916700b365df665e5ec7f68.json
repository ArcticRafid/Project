{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rafid\\\\OneDrive\\\\Desktop\\\\Project\\\\frontend\\\\src\\\\Hooks\\\\useCart.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport { useAuth } from './useAuth';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CartContext = /*#__PURE__*/createContext(null);\nconst cart_key = 'cart';\nconst empty_cart = {\n  items: [],\n  totalPrice: 0,\n  totalcount: 0\n};\nexport default function Provider({\n  children\n}) {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const userId = user ? user.id : 'guest';\n  const initcart = getCartFromLocal(userId);\n  const [cartItems, setCartItems] = useState(initcart.items);\n  const [totalPrice, setTotalPrice] = useState(initcart.totalPrice);\n  const [totalCount, setTotalCount] = useState(initcart.totalCount);\n  useEffect(() => {\n    const totalPrice = sum(cartItems.map(item => item.price));\n    const totalCount = sum(cartItems.map(item => item.quantity));\n    setTotalPrice(totalPrice);\n    setTotalCount(totalCount);\n    localStorage.setItem(cart_key, JSON.stringify({\n      items: cartItems,\n      totalPrice,\n      totalCount\n    }));\n  }, [cartItems]);\n  function getCartFromLocal(userID) {\n    const stored = localStorage.getItem(`${cart_key}_${userID}`);\n    return stored ? JSON.parse(stored) : empty_cart;\n  }\n  const sum = items => {\n    return items.reduce((prev, cur) => prev + cur, 0);\n  };\n  const removeitem = foodId => {\n    const filteredcart = cartItems.filter(item => item.food.id !== foodId);\n    setCartItems(filteredcart);\n  };\n  const changequant = (cartItem, newquant) => {\n    const {\n      food\n    } = cartItem;\n    const changes = {\n      ...cartItem,\n      quantity: newquant,\n      price: food.price * newquant\n    };\n    const updatedItems = cartItems.map(item => item.food.id === cartItem.food.id ? changes : item);\n    setCartItems(updatedItems);\n  };\n  const addmore = food => {\n    const cartItem = cartItems.find(item => item.food.id === food.id);\n    if (cartItem) {\n      changequant(cartItem, cartItem.quantity + 1);\n    } else {\n      setCartItems([...cartItems, {\n        food,\n        quantity: 1,\n        price: food.price\n      }]);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: {\n      cart: {\n        items: cartItems,\n        totalPrice,\n        totalCount\n      },\n      removeitem,\n      changequant,\n      addmore\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n}\n_s(Provider, \"90bT7fvgNgE9a0BnU6pJWx+1KAw=\", false, function () {\n  return [useAuth];\n});\n_c = Provider;\nexport const useCart = () => {\n  _s2();\n  return useContext(CartContext);\n};\n_s2(useCart, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"Provider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","useAuth","jsxDEV","_jsxDEV","CartContext","cart_key","empty_cart","items","totalPrice","totalcount","Provider","children","_s","user","userId","id","initcart","getCartFromLocal","cartItems","setCartItems","setTotalPrice","totalCount","setTotalCount","sum","map","item","price","quantity","localStorage","setItem","JSON","stringify","userID","stored","getItem","parse","reduce","prev","cur","removeitem","foodId","filteredcart","filter","food","changequant","cartItem","newquant","changes","updatedItems","addmore","find","value","cart","fileName","_jsxFileName","lineNumber","columnNumber","_c","useCart","_s2","$RefreshReg$"],"sources":["C:/Users/rafid/OneDrive/Desktop/Project/frontend/src/Hooks/useCart.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState } from 'react'\r\nimport { useAuth } from './useAuth';\r\n\r\nconst CartContext = createContext(null);\r\nconst cart_key = 'cart';\r\nconst empty_cart = {\r\n    items: [],\r\n    totalPrice: 0,\r\n    totalcount: 0,\r\n};\r\n\r\nexport default function Provider({children}) {\r\n    const { user } = useAuth();\r\n    const userId = user ? user.id : 'guest';\r\n    const initcart = getCartFromLocal(userId);\r\n    const [cartItems, setCartItems] = useState(initcart.items);\r\n    const [totalPrice, setTotalPrice] = useState(initcart.totalPrice);\r\n    const [totalCount, setTotalCount] = useState(initcart.totalCount);\r\n\r\n    useEffect(\r\n        () => {\r\n            const totalPrice = sum(cartItems.map(item => item.price))\r\n            const totalCount = sum(cartItems.map(item => item.quantity))\r\n            setTotalPrice(totalPrice);\r\n            setTotalCount(totalCount);\r\n\r\n            localStorage.setItem(cart_key, JSON.stringify({\r\n                items: cartItems,\r\n                totalPrice,\r\n                totalCount,\r\n            }))\r\n        }, [cartItems]\r\n    );\r\n\r\n    function getCartFromLocal(userID) {\r\n        const stored = localStorage.getItem(`${cart_key}_${userID}`);\r\n        return stored ? JSON.parse(stored) : empty_cart;\r\n    }\r\n    \r\n    const sum = items => {\r\n        return items.reduce((prev, cur) => prev + cur, 0)\r\n    }\r\n    const removeitem = foodId => {\r\n        const filteredcart = cartItems.filter(item => item.food.id !== foodId);\r\n        setCartItems(filteredcart);\r\n    }\r\n\r\n    const changequant = (cartItem, newquant) => {\r\n        const {food} = cartItem;\r\n\r\n        const changes = {\r\n            ...cartItem,\r\n            quantity: newquant,\r\n            price: food.price * newquant,\r\n        };\r\n        const updatedItems = cartItems.map(item => (item.food.id === cartItem.food.id ? changes : item));\r\n\r\n        setCartItems (\r\n            updatedItems\r\n        );\r\n        };\r\n\r\n        const addmore = food => {\r\n            const cartItem = cartItems.find(item => item.food.id === food.id);\r\n            if (cartItem) {\r\n                changequant(cartItem, cartItem.quantity +1);\r\n            }else {\r\n                setCartItems([...cartItems, {food, quantity: 1, price: food.price}]);\r\n            }\r\n        }\r\n\r\n    return (\r\n    <CartContext.Provider value={{cart: {items: cartItems, totalPrice, totalCount}, removeitem, changequant, addmore}}> \r\n        {children}\r\n    </CartContext.Provider>\r\n  )\r\n}\r\n\r\nexport const useCart = () => useContext(CartContext);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}